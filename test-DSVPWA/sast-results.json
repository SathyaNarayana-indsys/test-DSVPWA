{"critical":[{"cwe_ids":["502"],"id":"python_lang_avoid_pickle","title":"Usage of unsafe Pickle libraries","description":"## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code execution. It is best practices to avoid these libraries and to use a safer serialization formats like JSON.\n\n## Remediations\n\n- **Do not** use pickle or its derivatives for deserialization wherever possible. These libraries are open to security vulnerabilities.\n- **Do** use recommended safer formats like JSON, Protocol Buffers (protobuf) and MessagePack.\n ```python\n import msgpack #MessagePack\n\n data = {'key': 'value'}\n packed_data = msgpack.packb(data)\n ```\n\n## References\n\n- [OWASP Deserialization cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_avoid_pickle","line_number":185,"full_filename":"dsvpwa/attacks.py","filename":"dsvpwa/attacks.py","source":{"start":185,"end":185,"column":{"start":44,"end":85}},"sink":{"start":185,"end":185,"column":{"start":44,"end":85},"content":""},"parent_line_number":185,"fingerprint":"3bf6bf2fe18482b1d95689de336967ff_0","old_fingerprint":"3bf6bf2fe18482b1d95689de336967ff_0","code_extract":" payload = base64.urlsafe_b64encode(pickle.dumps(dict(one=1, two=2, three=3))).decode()"},{"cwe_ids":["502"],"id":"python_lang_avoid_pickle","title":"Usage of unsafe Pickle libraries","description":"## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code execution. It is best practices to avoid these libraries and to use a safer serialization formats like JSON.\n\n## Remediations\n\n- **Do not** use pickle or its derivatives for deserialization wherever possible. These libraries are open to security vulnerabilities.\n- **Do** use recommended safer formats like JSON, Protocol Buffers (protobuf) and MessagePack.\n ```python\n import msgpack #MessagePack\n\n data = {'key': 'value'}\n packed_data = msgpack.packb(data)\n ```\n\n## References\n\n- [OWASP Deserialization cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_avoid_pickle","line_number":187,"full_filename":"dsvpwa/attacks.py","filename":"dsvpwa/attacks.py","source":{"start":187,"end":187,"column":{"start":44,"end":68}},"sink":{"start":187,"end":187,"column":{"start":44,"end":68},"content":""},"parent_line_number":187,"fingerprint":"3bf6bf2fe18482b1d95689de336967ff_1","old_fingerprint":"3bf6bf2fe18482b1d95689de336967ff_1","code_extract":" payload = base64.urlsafe_b64encode(pickle.dumps(self.RCE())).decode()"},{"cwe_ids":["502"],"id":"python_lang_avoid_pickle","title":"Usage of unsafe Pickle libraries","description":"## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code execution. It is best practices to avoid these libraries and to use a safer serialization formats like JSON.\n\n## Remediations\n\n- **Do not** use pickle or its derivatives for deserialization wherever possible. These libraries are open to security vulnerabilities.\n- **Do** use recommended safer formats like JSON, Protocol Buffers (protobuf) and MessagePack.\n ```python\n import msgpack #MessagePack\n\n data = {'key': 'value'}\n packed_data = msgpack.packb(data)\n ```\n\n## References\n\n- [OWASP Deserialization cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_avoid_pickle","line_number":199,"full_filename":"dsvpwa/attacks.py","filename":"dsvpwa/attacks.py","source":{"start":199,"end":199,"column":{"start":27,"end":73}},"sink":{"start":199,"end":199,"column":{"start":27,"end":73},"content":""},"parent_line_number":199,"fingerprint":"3bf6bf2fe18482b1d95689de336967ff_2","old_fingerprint":"3bf6bf2fe18482b1d95689de336967ff_2","code_extract":" content = str(pickle.loads(base64.urlsafe_b64decode(object)))"},{"cwe_ids":["78"],"id":"python_lang_os_command_injection","title":"Unsanitized user input in OS command","description":"## Description\n\nDirectly incorporating external or user-defined input into an OS command exposes the system to possible command injection attacks. This vulnerability allows attackers to execute unauthorized commands on the operating system, potentially leading to a compromise of system integrity.\n\n## Remediations\n\n- **Do not** use OS commands that include dynamic input directly. Instead, explore safer alternatives such as libraries or built-in functions that achieve the same goal without executing system commands. \n- **Do** use hardcoded values for any input that is incorporated into OS commands. This approach minimizes the risk by ensuring only predefined inputs are used, thus preventing attackers from injecting malicious commands. Use safe lists or dictionaries if you need to be dynamic. \n\n## References\n\n- [OWASP command injection explained](https://owasp.org/www-community/attacks/Command_Injection)","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_os_command_injection","line_number":183,"full_filename":"dsvpwa/handlers.py","filename":"dsvpwa/handlers.py","source":{"start":183,"end":188,"column":{"start":23,"end":14}},"sink":{"start":183,"end":188,"column":{"start":23,"end":14},"content":""},"parent_line_number":183,"fingerprint":"cb1b49123cb1130b3cdc7bf24ca1eeb7_0","old_fingerprint":"cb1b49123cb1130b3cdc7bf24ca1eeb7_0","code_extract":" content = subprocess.check_output(\n self.path[1:],\n shell=True,\n stderr=subprocess.STDOUT,\n stdin=subprocess.PIPE\n )"},{"cwe_ids":["89"],"id":"python_lang_sql_injection","title":"Unsanitized external input in SQL query","description":"## Description\n\nUsing unsanitized data, such as user input or request data, or externally influenced data passed to a function, in SQL query exposes your application to SQL injection attacks. This vulnerability arises when externally controlled data is directly included in SQL statements without proper sanitation, allowing attackers to manipulate queries and access or modify data.\n\n## Remediations\n\n- **Do not** include raw external input in SQL queries. This practice can lead to SQL injection vulnerabilities.\n ```python\n sorting_order = request.GET[\"untrusted\"]\n query = f\"SELECT id, name FROM products ORDER BY name LIMIT 20 {sorting_order};\"; # unsafe\n ```\n- **Do** validate all external input to ensure it meets the expected format before including it in SQL queries.\n ```python\n sorting_order = \"DESC\" if request.GET[\"sortingOrder\"] == \"DESC\" else \"ASC\"\n ```\n- **Do** use parameters for database queries to separate SQL logic from external input, significantly reducing the risk of SQL injection.\n ```python\n cursor.execute(\"SELECT reports-repo FROM products WHERE id LIKE ?\", [f\"%{product_id}%\"])\n ```\n- **Do** escape all external input using appropriate database-specific escaping functions before including it in SQL queries.\n ```python\n from mysql.connector.conversion import MySQLConverter\n\n converter = MySQLConverter(connection)\n ok = converter.escape(request.GET[\"value\"])\n ```\n\n## References\n\n- [OWASP SQL injection explained](https://owasp.org/www-community/attacks/SQL_Injection)\n- [OWASP SQL injection prevention cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_sql_injection","line_number":39,"full_filename":"dsvpwa/attacks.py","filename":"dsvpwa/attacks.py","source":{"start":39,"end":39,"column":{"start":13,"end":113}},"sink":{"start":39,"end":39,"column":{"start":13,"end":113},"content":""},"parent_line_number":39,"fingerprint":"4b973e113821e66495565c29dc8b3f45_0","old_fingerprint":"4b973e113821e66495565c29dc8b3f45_0","code_extract":" cursor.execute(\"SELECT id, username, firstname, lastname, email, session FROM users WHERE id=\" + id)"}],"high":[{"cwe_ids":["79"],"id":"javascript_lang_dangerous_insert_html","title":"Unsanitized user input in dynamic HTML insertion (XSS)","description":"## Description\n\nUnsanitized user input in dynamic HTML insertion can lead to Cross-Site Scripting (XSS) attacks. This vulnerability arises when user-provided data is directly inserted into the DOM without proper sanitization, potentially allowing attackers to execute malicious scripts.\n\n## Remediations\n\n- **Do** use an HTML sanitization library to clean user input before inserting it into the HTML. This step helps prevent XSS attacks by removing or neutralizing any potentially harmful scripts.\n ```javascript\n import sanitizeHtml from 'sanitize-html';\n\n const html = `<strong>${user.Input}</strong>`;\n document.body.innerHTML = sanitizeHtml(html);\n ```\n\n## References\n\n- [OWASP XSS explained](https://owasp.org/www-community/attacks/xss/)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_dangerous_insert_html","line_number":9,"full_filename":"static/js/custom.js","filename":"static/js/custom.js","source":{"start":9,"end":9,"column":{"start":5,"end":181}},"sink":{"start":9,"end":9,"column":{"start":5,"end":181},"content":""},"parent_line_number":9,"fingerprint":"f4e2a2d270c2200d52efc1efe98a1b9a_0","old_fingerprint":"f4e2a2d270c2200d52efc1efe98a1b9a_0","code_extract":" document.write('<div style=\\\"position: absolute; top: 5px; right: 5px;\\\">Chosen language: <b>' + decodeURIComponent(document.location.hash.substring(index + 5)) + '</b></div>');"},{"cwe_ids":["22"],"id":"python_lang_path_traversal","title":"Unsanitized dynamic input in file path","description":"## Description\n\nUsing unsanitized dynamic input to determine file paths can allow attackers to gain access to files and folders outside of the intended scope. This vulnerability occurs when input provided by users is directly used to access the filesystem without proper validation or sanitization.\n\n## Remediations\n\n- **Do not** directly use external input to construct file paths. This can lead to unauthorized file access.\n- **Do** use a safelist to define accessible paths or directories. Only allow user input to influence file paths within these predefined, safe boundaries.\n- **Do** use absolute path checks to confirm that the constructed path is within the expected directory\n ```python\n BASE_DIRECTORY = '/path/to/safe/directory'\n my_path = os.path.abspath(os.path.join(BASE_DIRECTORY, dynamic_input))\n\n if my_path.startswith(BASE_DIRECTORY):\n open(my_path)\n ```\n\n## References\n\n- [OWASP Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_path_traversal","line_number":94,"full_filename":"dsvpwa/handlers.py","filename":"dsvpwa/handlers.py","source":{"start":94,"end":94,"column":{"start":28,"end":74}},"sink":{"start":94,"end":94,"column":{"start":28,"end":74},"content":""},"parent_line_number":94,"fingerprint":"c421c75d5abbc60fe838d865be225bb2_0","old_fingerprint":"c421c75d5abbc60fe838d865be225bb2_0","code_extract":" self.content = open('templates/{}'.format(route['template']))"},{"cwe_ids":["22"],"id":"python_lang_path_traversal","title":"Unsanitized dynamic input in file path","description":"## Description\n\nUsing unsanitized dynamic input to determine file paths can allow attackers to gain access to files and folders outside of the intended scope. This vulnerability occurs when input provided by users is directly used to access the filesystem without proper validation or sanitization.\n\n## Remediations\n\n- **Do not** directly use external input to construct file paths. This can lead to unauthorized file access.\n- **Do** use a safelist to define accessible paths or directories. Only allow user input to influence file paths within these predefined, safe boundaries.\n- **Do** use absolute path checks to confirm that the constructed path is within the expected directory\n ```python\n BASE_DIRECTORY = '/path/to/safe/directory'\n my_path = os.path.abspath(os.path.join(BASE_DIRECTORY, dynamic_input))\n\n if my_path.startswith(BASE_DIRECTORY):\n open(my_path)\n ```\n\n## References\n\n- [OWASP Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_path_traversal","line_number":116,"full_filename":"dsvpwa/handlers.py","filename":"dsvpwa/handlers.py","source":{"start":116,"end":116,"column":{"start":32,"end":63}},"sink":{"start":116,"end":116,"column":{"start":32,"end":63},"content":""},"parent_line_number":116,"fingerprint":"c421c75d5abbc60fe838d865be225bb2_1","old_fingerprint":"c421c75d5abbc60fe838d865be225bb2_1","code_extract":" self.content = open('./{}'.format(path), 'rb')"},{"cwe_ids":["22"],"id":"python_lang_path_traversal","title":"Unsanitized dynamic input in file path","description":"## Description\n\nUsing unsanitized dynamic input to determine file paths can allow attackers to gain access to files and folders outside of the intended scope. This vulnerability occurs when input provided by users is directly used to access the filesystem without proper validation or sanitization.\n\n## Remediations\n\n- **Do not** directly use external input to construct file paths. This can lead to unauthorized file access.\n- **Do** use a safelist to define accessible paths or directories. Only allow user input to influence file paths within these predefined, safe boundaries.\n- **Do** use absolute path checks to confirm that the constructed path is within the expected directory\n ```python\n BASE_DIRECTORY = '/path/to/safe/directory'\n my_path = os.path.abspath(os.path.join(BASE_DIRECTORY, dynamic_input))\n\n if my_path.startswith(BASE_DIRECTORY):\n open(my_path)\n ```\n\n## References\n\n- [OWASP Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_path_traversal","line_number":118,"full_filename":"dsvpwa/handlers.py","filename":"dsvpwa/handlers.py","source":{"start":118,"end":118,"column":{"start":32,"end":62}},"sink":{"start":118,"end":118,"column":{"start":32,"end":62},"content":""},"parent_line_number":118,"fingerprint":"c421c75d5abbc60fe838d865be225bb2_2","old_fingerprint":"c421c75d5abbc60fe838d865be225bb2_2","code_extract":" self.content = open('./{}'.format(path), 'r')"},{"cwe_ids":["327"],"id":"python_lang_weak_random","title":"Usage of weak Pseudo-Random Number Generator (PRNG)","description":"## Description\n\nThe `random` module in Python generates pseudorandom numbers that are not secure for cryptographic purposes. These numbers can be predicted if the seed is known, posing a risk to the security of applications that use them for generating secrets, tokens, or other security-sensitive elements.\n\n## Remediations\n\n- **Do** use `secrets` instead of `random` for generating random numbers in contexts where security is crucial. This ensures the randomness is cryptographically secure and unpredictable.\n- **Do not** use `random` for generating random numbers in cryptographic applications, including but not limited to key generation, authentication tokens, or security challenges.\n- **Do not** initialize `random` with predictable seeds, such as timestamps or other easily guessable values, if it is required to use `random`.\n\n## References\n\n- [secrets module documentation](https://docs.python.org/3/library/secrets.html)","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_weak_random","line_number":202,"full_filename":"dsvpwa/handlers.py","filename":"dsvpwa/handlers.py","source":{"start":202,"end":202,"column":{"start":29,"end":84}},"sink":{"start":202,"end":202,"column":{"start":29,"end":84},"content":""},"parent_line_number":202,"fingerprint":"4287d531c9b43e9a70c8ee1c24335d08_0","old_fingerprint":"4287d531c9b43e9a70c8ee1c24335d08_0","code_extract":" token = ''.join(random.sample(string.ascii_letters + string.digits, 20))"}],"medium":[{"cwe_ids":["208"],"id":"javascript_lang_observable_timing","title":"Observable Timing Discrepancy","description":"## Description\n\nObservable Timing Discrepancy occurs when the time it takes for certain operations to complete can be measured and observed by attackers. This vulnerability is particularly concerning when operations involve sensitive information, such as password checks or secret comparisons. If attackers can analyze how long these operations take, they might be able to deduce confidential details, putting your data at risk.\n\n## Remediations\n\n- **Do** implement algorithms that process sensitive information in constant time. This approach helps prevent attackers from guessing secrets based on the duration of operations.\n- **Do** use built-in security features and cryptographic libraries that offer functions safe from timing attacks for comparing secret values.\n- **Do not** use direct string comparisons for sensitive information, as this can lead to early termination of the function if a mismatch is found, revealing timing information.\n ```javascript\n if (apiToken === \"zDE9ET!TDq2uZx2oM!FD2\") { // unsafe\n ...\n }\n ```\n- **Do not** design application logic that changes execution paths in a manner that could introduce timing discrepancies based on user input or secret values.\n\n## References\n\n- [OWASP Guide to Cryptography](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [MDN Web Docs on SubtleCrypto API](https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto)","documentation_url":"https://docs.bearer.com/reference/rules/javascript_lang_observable_timing","line_number":7,"full_filename":"static/js/custom.js","filename":"static/js/custom.js","source":{"start":7,"end":7,"column":{"start":5,"end":16}},"sink":{"start":7,"end":7,"column":{"start":5,"end":16},"content":""},"parent_line_number":7,"fingerprint":"8b808e8981870f0bf705590429049e7e_0","old_fingerprint":"8b808e8981870f0bf705590429049e7e_0","code_extract":"if (index != -1)"}]}
